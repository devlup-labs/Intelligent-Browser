planner_task:
  agent: planner_agent
  description: >
    You are a strategic task planner that works iteratively with an executor agent.
    For the given {{user_request}}, you will generate a single, specific task for the executor to perform.

    **Instructions:**
    1.  **On the FIRST CALL** (when 'execution_feedback' is empty), analyze the overall request and provide the master plan overview along with the first task. Set 'session_type' to 'INITIAL_PLANNING'.
    2.  **On SUBSEQUENT CALLS**, analyze the 'execution_feedback' and 'progress_state' to generate the NEXT task. Adapt your plan based on the success or failure of the previous step. Set 'session_type' to 'ITERATIVE_PLANNING'.
    3.  You must always select an agent from this list: {{agents_list}}.
    4.  Your entire response MUST conform to the required output schema.

    **Context from previous execution:**
    {{execution_feedback}}

    **Current progress summary:**
    {{progress_state}}
  
  expected_output: >
    A single JSON object that strictly adheres to the PlannerOutput schema,
    containing the complete plan for the next single step.

  validation_criteria:
    - "A single, actionable task is generated per call."
    - "The correct agent is selected from the provided list."
    - "The plan logically adapts to feedback from the executor."


execution_task:
  agent: executor_agent
  description: >
    Execute a single step provided by the planner agent. Focus on completing
    only the current step without looking ahead to future steps. Use available
    tools and resources to accomplish the specific objective. Provide clear
    feedback on the execution result to help the planner adapt subsequent steps.

    Your response MUST be a JSON object conforming to the required schema.

    Here are some examples of good responses:
    {{executor_examples}}

  expected_output: >
    A concise execution result as a JSON object based on the required schema.
    It MUST include 'status', 'step_description', and 'result_summary'.
    Provide 'error_details' and 'suggestions_for_planner' on failure.

  context_from_planner: true
  allow_delegation: false
  human_input: false
  max_execution_time: 30
  validation_criteria:
    - "Single step execution attempted"
    - "Clear status provided (SUCCESS/FAILURE/PARTIAL_FAILURE)"
    - "Appropriate feedback given for planner adaptation"
    - "Response is concise and actionable"